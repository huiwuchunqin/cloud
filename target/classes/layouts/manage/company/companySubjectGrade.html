<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<#include "/manage/common/meta_js.html"/> 
<#include "/manage/common/meta_css.html"/>
</head>
<style>
ul{ width:300px;padding:20px}
li{width:100px;float:left;padding:5px;    line-height:20px;}
li span{margin-left:20px;height:23px;line-height:34px;font-family: "微软雅黑", Helvetica, Arial, sans-serif}
a{margin-left:20px;width:80px;height:28px;line-height:28px}
</style>
<body class="easyui-layout" style="padding:10px">
<div style="padding:5px;"data-options="region:'center',fit:true" >
<a class="easyui-linkbutton" iconCls="icon-ok" onclick="selectAll()">勾选全部</a>
<ul id="gradeList" data-bind="foreach:gradeList" >
	<li>
		<input type="checkbox" data-bind="value:gradeCode,checked:(selected()==1),enable:(editable()==1)">
		<span data-bind="text:gradeName"> </span>

	</li>
</ul>
</div>
<div data-options="region:'south'" style="height:40px;text-align:center">
	<a class="btn btnConfirm"  iconCls="icon-save" onclick="saveSubjectGrade()">保存</a>
	<a class="btn btnCancel"  iconCls="icon-cancel" onclick="javascript:easyui_closeTopWindow(false)">取消</a>
</div>
<script type="text/javascript">
var gradeList=eval(${gradeList})||[];
$(function(){
	var model=ko.mapping.fromJS({'gradeList':gradeList});
	ko.applyBindings(model,$('#gradeList')[0])
})
function selectAll(){
	$("input[type='checkBox']:enabled").each(function(){
		$(this).prop("checked",true);
	})	
}
//保存学科年级关系
function saveSubjectGrade(){
	var gradeCodes=new Array();
	$("input[type='checkBox']:checked").each(function(){
		gradeCodes.push(this.value);
	})
	$.ajax({
		url:'/manage/companyGradeSubject/saveGradeSubject.html',
		data:{
			gradeCodes:gradeCodes,
			subjectCode:"${subjectCode}",
		},
		type:'post',
		success:function(res){
			$.messager.alert("信息",res.msg,"info",function(){
				easyui_closeTopWindow();
			});
		}
	})
}
</script>
</body>
</html>