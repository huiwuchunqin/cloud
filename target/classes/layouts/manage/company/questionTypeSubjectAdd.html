<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>学科题型新增</title>
<#include "/manage/common/meta_js.html"/> 
<#include "/manage/common/meta_css.html"/>
<script type="text/javascript" src="/manage/template/comboChange/comboChange.js"></script>
<style type="text/css">
.labelLine250 input[type='radio'] {
	width: 16px;
	height: 20px;
	margin-left: 28px;
}
</style>
</head>
<body>
<div class="box">
	<div class="labelLine250">
		<span class="labelWidth90">学段：</span> <input id="section" class="easyui-combobox" data-options="onChange:sectionChange,textField:'name',valueField:'code',editable:false">
	</div>
	<span class="clear10"></span>
	<div class="labelLine250">
		<span class="labelWidth90">学科：</span> <input id="subject" class="easyui-combobox" data-options="textField:'name',valueField:'code',editable:false">
	</div>
	<span class="clear10"></span>
	<div class="labelLine250">
		<span class="labelWidth90">题型：</span><input id="questionType" class="easyui-combobox" data-options="onSelect:questionTypeSelect,textField:'name',valueField:'code',editable:false">
	</div>
	<span class="clear10"></span>
	<div class="labelLine250">
		<span class="labelWidth90">题型名称：</span><input class="easyui-validatebox" id="name" maxlength="20"/>
	</div>
	<span class="clear10"></span>
	<div class="labelLine250">
	    <span class="labelWidth90">支持听力：</span><input type="radio" name="flagSupportListening" value="1"/>是<input type="radio" checked="checked" name="flagSupportListening" value="0"/>否
	</div>
	<span class="clear10"></span>
	<div class="labelLine250" id="defaultTextType" style="display: none">
	    <span class="labelWidth90">默认显示文本：</span><input id="textType" class="easyui-combobox" data-options="textField:'name',valueField:'code',editable:false,data:[{code:'0',name:'富文本',selected:true},{code:'1',name:'普通文本'}]"/>
	</div>
	<span class="clear20"></span>
	<div class="textCenter">
		<a class="btn btnConfirm"  onclick="save()">保存</a>
		<a class="btn btnCancel" onclick="cancel()">取消</a> 
	</div>
</div>
<script type="text/javascript"> 
var sectionList=eval(${sectionList});
var questionTypeList=eval(${questionTypeList});
$(function(){
	$('#section').combobox('loadData',sectionList);
	$('#questionType').combobox('loadData',questionTypeList);
})
function save(){
	var questionType=$('#questionType').combobox('getValue');
	var name=$('#name').val().trim();
	var subjectCode=$('#subject').combobox('getValue');
	var sectionCode=$('#section').combobox('getValue');
	var flagSupportListening=$("input[name='flagSupportListening']:checked").val();
	var textType=$("#textType").combobox('getValue');
	var select=_.find(questionTypeList,function(item){
		return item.code==questionType;
	})
	if(sectionCode==null||sectionCode==""){
		$.messager.alert('消息','学段不能为空！','info');
        return;
	}
	if(subjectCode==null||subjectCode==""){
		$.messager.alert('消息','学科不能为空！','info');
        return;
	}
	if(questionType==null||questionType==""){
		$.messager.alert('消息','题型不能为空！','info');
        return;
	}
	if(name==null||name==""){
		$.messager.alert('消息','题型名称不能为空！','info');
        return;
	}
	if(flagSupportListening==null||flagSupportListening==""){
		$.messager.alert('消息','支持听力不能为空！','info');
        return;
	}
	$.ajax({
		url:"/manage/questionTypeSubject/addQuestionTypeSubject.html",
		type : "POST",
		data:{
			subjectCode:subjectCode,
			questionType:questionType,
			name:name,
			flagSysEvaluate:select.flagSysEvaluate,
			flagSupportListening:flagSupportListening,
			textType:textType
		},
		success:function(res){
			$.messager.alert("信息",res.msg,"info",function(){
				easyui_closeTopWindow(res.success);
			})
		}
	});
}
//取消
function cancel(){
	easyui_closeTopWindow(false);
}
//学段改变
function sectionChange(record){
	sectionSubject(record,$('#subject'));
}

//题型选择事件
function questionTypeSelect(record){
	if(record.flagSysEvaluate=="0"){
		$("#defaultTextType").show();
	}else{
		$("#defaultTextType").hide();
	}
}
</script>
</body>
</html>