<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<#include "/manage/common/meta_js.html"/>
<#include "/manage/common/meta_css.html"/>
<script type="text/javascript" src="/manage/template/loginUser/loginUser.js"></script>
<title>教研员列表</title>
</head>
<body>
<div id="tb">
	<div class="box form">
	<div class="labelBox">
		<div class="labelLine250">
			<span class="labelWidth60">姓名：</span><input id="userName" placeholder="请输入姓名"/>
		</div>
	</div>
	<div class="btnBox">
	    <a class="btn btnBlue search" data-options="iconCls:'icon-search'" onclick="reload()">查询</a>
		<a class="btn btnBlue add" data-options="iconCls:'icon-add'" onclick="add()">新增</a>
	</div>
	</div>
</div>
	<table id="dg" class="easyui-datagrid"
		data-options="
		    pagination:true,
		    toolbar:'#tb',
		    fit:true,
		    rownumbers:true,
		    singleSelect:true,
		    url:'/manage/eduStaff/search.html',
		    onBeforeLoad:onBeforeLoad,
		 	onRowContextMenu:onRowContextMenu
	    ">
		<thead>
			<tr>
				<th data-options="field:'opt',width:200,halign:'center',align:'center',formatter:eduStaffOptfmt">操作</th>
				<th data-options="field:'userName',width:120,halign:'center',align:'left'">姓名</th>
				<th data-options="field:'loginAccount',width:120,halign:'center',align:'left'">登录账号</th>
				<th data-options="field:'status',width:90,formatter:statusfmt,align:'center',halign:'center'">状态</th>
				<th data-options="field:'mobilePhone',width:120,halign:'center',align:'center'">手机号</th>
				<th data-options="field:'mail',width:140,halign:'center',align:'left'">邮箱</th>
				<th data-options="field:'modifyTime',width:160,halign:'center',align:'center'">开通时间</th>
			</tr>
		</thead>
	</table>
	 <div id="menu" class="easyui-menu" style="width: 120px">
		 <div data-options="iconCls:'icon-edit',name:'useful'">设为有效</div>   
	   	 <div data-options="iconCls:'icon-edit',name:'useless'">设为无效</div>   
		 <div data-options="iconCls:'icon-edit',name:'modifypwd'">修改密码</div>
	</div> 
	<script type="text/javascript">
		function onBeforeLoad(param){
			param["userName"]=$('#userName').val();
		}

		//新增教研员
		function add(){
			easyui_openNoResizeWindow("新增教研员",1000,800,"/manage/teacher/toTeacherInfo.html?type=30",function(r){
				if(r){
					reload();
				}
			})
		}
		
		//撤销
		function recall(_userCode){
			$.messager.confirm("信息","确认要撤销该用户的角色吗？",function(r){
				if(r){
					$.ajax({
						url:'/manage/recallAdmin.html',
						data:{
							userCode:_userCode,
							type:"${type}"
						},
						success:function(res){
							alert(res.msg);
							reload();
						}
					})
				}
			});
		}
		
		//操作列格式化
		function eduStaffOptfmt(value,row){
			var str= "<a href='javascript:void(0)' onclick='modify(\""+row.userCode+"\")'>修改</a>&nbsp;&nbsp;<a href='javascript:void(0)' onclick='recall(\""+row.userCode+"\")'>撤销</a>";
			str=str+"&nbsp;&nbsp;<a href='javascript:void(0)' onclick='checkAuthSet(\""+row.userCode+"\",\""+row.loginAccount+"\")'>审核权限设置</a>";
			return str;
		}
		
		//审核权限设置
		function checkAuthSet(userCode,loginAccount){
			var url="/manage/eduStaff/authSet.html?userCode="+userCode+"&loginAccount="+loginAccount;
			easyui_openNoResizeWindow("审核权限设置",880,460,url,function(r){
				if(r){
					reload();
				}
			})
		}
		
	</script>
</body>
</html>