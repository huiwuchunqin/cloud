<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<#include "/manage/common/meta_js.html"/> <#include
"/manage/common/meta_css.html"/>
</head>
<title>机构学科新增</title>
<style>
.container {
	min-width: 700px;
	height: 500px;
	padding: 20px 20px;
	position: relative;
	overflow: hidden;
}

.left {
	width: 450px;
	height: 100%;
}

.right {
	position: absolute;
	left: 555px;
	top: 20px;
	width: 406px;
	height: 100%;
}

.center {
	position: absolute;
	left: 490px;
	top: 100px;
	width: 286px;
	height: 100%;
}
</style>
<body class="container">
	<div id="unselected" class="left">
		<div id="tb"
			style="color: red; font-size: 19px; line-height: 27px; height: 27px">
			如学科不在本表，请联系平台管理员添加。</div>
		<table id="unSelectedDg" class="easyui-datagrid"
			data-options="
		    fitColumns:true,
		    fit:true,
		    rownumbers:true,
		    url:'/manage/companySubject/subjectNotSelectList.html',
		    idField:'code',
		    toolbar:'#tb',
		    ">
			<thead>
				<tr>
					<th
						data-options="field:'ck',checkbox:true,width:50,headalign:'center'"></th>
					<th data-options="field:'name',width:100,halign:'center'">可选学科</th>
					<th data-options="field:'description',width:150,halign:'center'">描述</th>
				</tr>
			</thead>
		</table>
	</div>

	<div class="center">
		<span class="clear" style="height: 60px"></span> <img
			src="/manage/template/images/right.png" onclick="addSubject()" /> <span
			class="clear" style="height: 60px"></span> <img
			src="/manage/template/images/left.png" onclick="removeSubject()" />
	</div>
	<div id="selected" class="right">
		<table id="selectedDg" class="easyui-datagrid"
			data-options="
		    fitColumns:true,
		    fit:true,
		    rownumbers:true,
		    idField:'code',
		    url:'/manage/companySubject/subjectList.html'
		    ">
			<thead>
				<tr>
					<th
						data-options="field:'ck',checkbox:true,width:50,headalign:'center'"></th>
					<th data-options="field:'name',width:100,halign:'center'">已选学科</th>
					<th data-options="field:'description',width:150,halign:'center'">描述</th>
				</tr>
			</thead>
		</table>
	</div>
	<script type="text/javascript">
		function onResize() {
			$('#unselected').width($(window).width() * 0.55);
			$('#selected').width($(window).width() * 0.4);
			$('#selectedDg').datagrid('resize');
			$('#unSelectedDg').datagrid('resize');
		}

		$(window).resize(onResize);
		//保存学科
		function addSubject() {
			var rows = $('#unSelectedDg').datagrid('getSelections');
			if (rows == undefined || rows == null || rows.length <= 0) {
				$.messager.alert("信息", "请选择要添加的学科", "info");
				return false;
			}
			var subjectCodes = new Array();
			$.each(rows, function() {
				subjectCodes.push(this.code);
			})
			$.ajax({
				url : '/manage/companySubject/addSubject.html',
				data : {
					subjectCodes : subjectCodes,

				},
				type : 'post',
				success : function(res) {
					$('#selectedDg').datagrid('reload');
					$('#unSelectedDg').datagrid('reload');
					$('#unSelectedDg').datagrid('unselectAll');

				}
			})
		}
		// 删除学科
		function removeSubject() {
			var rows = $('#selectedDg').datagrid('getSelections');
			if (rows == undefined || rows == null || rows.length <= 0) {
				$.messager.alert("信息", "请选择要移除的学科", "info");
			}
			var subjectCodes = new Array();
			$.each(rows, function() {
				subjectCodes.push(this.code);
			})
			$.ajax({
				url : '/manage/companySubject/deleteSubject.html',
				data : {
					subjectCodes : subjectCodes
				},
				type : 'post',
				success : function(res) {
					$('#selectedDg').datagrid('reload');
					$('#unSelectedDg').datagrid('reload');
				}
			})
		}
	</script>
</body>
</html>